<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:sec="http://www.springframework.org/schema/security"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
            http://www.springframework.org/schema/security
            http://www.springframework.org/schema/security/spring-security-3.2.xsd">
    
    <import resource="classpath:applicationContext.xml" />
    
    <sec:global-method-security>
        <sec:protect-pointcut 
            expression="execution(* pl.edu.uj.ii.ionb.airportmanager.backend.services.impl.*ServiceImpl.get*(..))"
            access="ROLE_USER"/>
        <sec:protect-pointcut 
            expression="execution(* pl.edu.uj.ii.ionb.airportmanager.backend.services.impl.*ServiceImpl.create*(..))"
            access="ROLE_ADMIN"/>
        <sec:protect-pointcut 
            expression="execution(* pl.edu.uj.ii.ionb.airportmanager.backend.services.impl.*ServiceImpl.remove*(..))"
            access="ROLE_ADMIN"/>
        <sec:protect-pointcut 
            expression="execution(* pl.edu.uj.ii.ionb.airportmanager.backend.services.impl.*ServiceImpl.update*(..))"
            access="ROLE_ADMIN"/>
    </sec:global-method-security>
    
 </beans>
